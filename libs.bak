#!/usr/bin/env python
# -*- coding: utf-8 -*-

import urllib, urllib2
from lxml import etree
import re

def baidu_search(content="", page=0):
    p = {
            'wd': content,
            'pn': (page-1)*10,
            'ie': 'utf-8',
	    #'usm': 1
        }
    res = urllib2.urlopen("http://www.baidu.com/s?" + urllib.urlencode(p))
    html = res.read()
    return html

def baidu_urlparse(content=""):
    pass

if __name__ == '__main__':
    for i in range(1, 76, 1):
        print i
    	html = baidu_search('百变大咖秀', i)
        html = html.replace("\n", "")
        all_buf = re.findall('(<div class="result.*? id=".*?)(?=</div>)', html)
        if len(all_buf) == 10:
            pass
        else:
            all_buf.extend(re.findall('(<table class="result.*? id=".*?)(?=</table>)', html))
        if len(all_buf) != 10:
            print (i-1)*10
    	fd = open("html/%d.html" % i, 'w')
    	fd.write(html)
    	fd.close()

